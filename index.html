<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Solana Dashboard â€” Wallet & Hot Pools</title>
<style>
body {
  margin:0; font-family:Arial, sans-serif; background:#0f0f13; color:#fff; padding:16px;
}
h1,h2{color:#55ff99;text-align:center;}
input, button, select {padding:6px 10px; border-radius:6px; border:none; margin:4px;}
button{background:#1b1b1f; color:#fff; cursor:pointer;}
button:hover{background:#333;}
section{margin-bottom:16px;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:12px;}
.card{background:#1b1b1f; padding:12px; border-radius:12px; border:1px solid rgba(255,255,255,0.03);}
.token-header{display:flex; align-items:center; gap:10px; margin-bottom:8px;}
.logo{width:44px;height:44px;border-radius:10px;object-fit:cover;background:#07070a;}
.small{font-size:12px;color:#aaa;}
.copy-btn{cursor:pointer;color:#55ff99;margin-left:6px;}
</style>
</head>
<body>

<h1>Solana Dashboard</h1>

<section>
  <h2>Wallet Tracker</h2>
  <input id="walletInput" placeholder="Inserisci indirizzo wallet Solana" style="width:70%"/>
  <button id="fetchWallet">Mostra Token</button>
  <div id="walletGrid" class="grid"><p class="small">Inserisci un wallet e premi "Mostra Token"</p></div>
</section>

<section>
  <h2>Hot Pools</h2>
  <div id="hotGrid" class="grid"><p class="small">Caricamento hot pools...</p></div>
</section>

<script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.85.2/lib/index.iife.min.js"></script>
<script>
const walletGrid = document.getElementById('walletGrid');
const hotGrid = document.getElementById('hotGrid');
const walletInput = document.getElementById('walletInput');
const fetchWalletBtn = document.getElementById('fetchWallet');

const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('mainnet-beta'), 'confirmed');
const REFRESH_MS = 15000; // auto-refresh ogni 15 sec

// Helper: format numero
function fmt(v){ return '$'+(v||0).toLocaleString(undefined,{maximumFractionDigits:2}); }
function copyToClipboard(text){ navigator.clipboard.writeText(text); }

// -------- WALLET --------
async function fetchWalletTokens(walletAddr){
  walletGrid.innerHTML = '<p class="small">Caricamento token...</p>';
  try{
    const pubKey = new solanaWeb3.PublicKey(walletAddr);
    const tokenAccounts = await connection.getParsedTokenAccountsByOwner(pubKey, {programId: solanaWeb3.TOKEN_PROGRAM_ID});
    if(!tokenAccounts.value.length){ walletGrid.innerHTML='<p class="small">Nessun token trovato.</p>'; return; }

    walletGrid.innerHTML='';
    tokenAccounts.value.forEach(acc=>{
      const info = acc.account.data.parsed.info;
      const amount = info.tokenAmount.uiAmount;
      const mint = info.mint;
      const card = document.createElement('div'); card.className='card';
      card.innerHTML = `
        <div class="token-header">
          <img class="logo" src="" alt="${mint}"/>
          <div>
            <div>${mint}</div>
            <div class="small">QuantitÃ : ${amount}</div>
            <div class="small">Contract: <a href="https://solscan.io/token/${mint}" target="_blank">${mint.slice(0,6)}...${mint.slice(-6)}</a>
              <span class="copy-btn" data-mint="${mint}">ðŸ“‹</span>
            </div>
          </div>
        </div>
      `;
      walletGrid.appendChild(card);
    });
    document.querySelectorAll('.copy-btn').forEach(btn=>{
      btn.onclick=()=>{ copyToClipboard(btn.getAttribute('data-mint')); btn.textContent='âœ…'; setTimeout(()=>btn.textContent='ðŸ“‹',1000); };
    });
  }catch(e){ walletGrid.innerHTML=`<p class="small">Errore: ${e.message||e}</p>`; }
}

fetchWalletBtn.onclick=()=>{ const w=walletInput.value.trim(); if(w) fetchWalletTokens(w); };

// -------- HOT POOLS SIMULATI --------
// Per MVP useremo dati simulati (da API pubbliche servono backend per real-time)
async function fetchHotPools(){
  hotGrid.innerHTML='<p class="small">Caricamento hot pools...</p>';
  // Simula 10 token con movimenti casuali
  const now=Date.now();
  const dummyTokens = Array.from({length:10},(_,i)=>({
    name:'Token'+(i+1),
    symbol:'T'+(i+1),
    mint:'Mint'+i+Math.floor(Math.random()*9999),
    liquidityUsd:Math.floor(Math.random()*50000)+500,
    volumeUsd:Math.floor(Math.random()*100000),
    createdAt:now-Math.floor(Math.random()*3600000*24),
    socials:{twitter:'https://x.com',telegram:'https://t.me'}
  }));

  hotGrid.innerHTML='';
  dummyTokens.forEach(t=>{
    const card=document.createElement('div'); card.className='card';
    const ageMs=Date.now()-t.createdAt;
    const h=Math.floor(ageMs/3600000), m=Math.floor((ageMs%3600000)/60000), s=Math.floor((ageMs%60000)/1000);
    let socialHtml='';
    for(const [k,v] of Object.entries(t.socials)){ socialHtml+=`<a href="${v}" target="_blank">${k}</a> `; }
    card.innerHTML=`
      <div class="token-header">
        <img class="logo" src="" alt="${t.symbol}"/>
        <div>
          <div>${t.name} (${t.symbol})</div>
          <div class="small">Liquidity: ${fmt(t.liquidityUsd)}, Volume: ${fmt(t.volumeUsd)}</div>
          <div class="small">Age: ${h}h ${m}m ${s}s</div>
          <div class="small">Contract: <a href="https://solscan.io/token/${t.mint}" target="_blank">${t.mint}</a>
            <span class="copy-btn" data-mint="${t.mint}">ðŸ“‹</span>
          </div>
          <div class="small social-links">${socialHtml}</div>
        </div>
      </div>
    `;
    hotGrid.appendChild(card);
  });
  document.querySelectorAll('.copy-btn').forEach(btn=>{
    btn.onclick=()=>{ copyToClipboard(btn.getAttribute('data-mint')); btn.textContent='âœ…'; setTimeout(()=>btn.textContent='ðŸ“‹',1000); };
  });
}

fetchHotPools();
setInterval(fetchHotPools, REFRESH_MS);
</script>
</body>
</html>
